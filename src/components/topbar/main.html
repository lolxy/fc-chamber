<div id="topbar" class="topbar">
    <div class="container">
        <template v-if="myIdentities.loaded">
          <ul class="nav navbar-nav hidden-xs">
            <li class="dropdown account-settings-menu" dropdown>
              <a href class="dropdown-toggle" data-toggle="dropdown">
                <span class="hidden-sm hidden-md realname">
                  <template v-if="cIdentity.Name">
                    {{ cIdentity.Name }}
                  </template>
                  <template v-else>
                    {{ myProfile.RealName }}
                  </template>
                </span>
                <b class="caret"></b>
              </a>
              <ul class="dropdown-menu w">
                <li>
                  <router-link :to="{ name: 'my.settings.profile' }">
                    <i class="fa fa-edit"></i> 账号设置
                  </router-link>
                </li>
                <li class="divider"></li>
                <li>
                  <a @click="logout"><i class="fa fa-sign-out"></i> 退出</a>
                </li>
              </ul>
            </li>
            <li class="menu-contact">
              <template v-if="auth">
                <a @click="toggleContactPanel" :class="{'active': contactVisible}">
                  <span><i class="fa fa-commenting"></i> 好友消息</span>
                  <b class="badge bg-danger" v-if="msgUnreadCount">{{ msgUnreadCount }}</b>
                  <b class="caret" :class="{'open': contactVisible}"></b>
                </a>
              </template>
              <template v-else>
                <a href="/access/login">
                  <span><i class="fa fa-commenting"></i> 好友消息</span>
                </a>
              </template>
            </li>
            <li>
              <a @click="goToPage('circles.friends.stream')" :class="{'active': routeName == 'circles.friends.stream' && !contactVisible}"><i class="fa fa-stumbleupon"></i> 好友商圈</a>
            </li>
            <li v-if="auth">
              <a @click="goToPage('oa.index')" :class="{'active': routeRoot == 'oa'}">协同办公</a>
            </li>
          </ul>
        </template>
        <template v-else>
          <ul class="nav navbar-nav not-login hidden-xs">
            <li>
              <a @click="openLoginDialog">登录</a>
            </li>
            <li>
              <a @click="goToPage('signup.index')">免费注册</a>
            </li>
            <li>
              <a href="//www.fccn.cc/app" target="_blank">辅城手机版</a>
            </li>
          </ul>
        </template>

        <ul class="nav navbar-nav navbar-right hidden-xs">
          <li v-if="cIdentity && cIdentity.CompanyId">
            <router-link class="my-company-link" :to="{ name: 'company.profile', params: { id: myCompanyId } }">
              <span><i class="fa fa-building"></i> 我的公司</span>
            </router-link>
          </li>
          <li v-if="chamId">
            <router-link :to="{ name: 'cham.index', params: { chamId: chamId } }">
              <span><i class="fa fa-users"></i> 我的商会</span>
            </router-link>
          </li>
          <li v-if="mallId">
            <router-link :to="{ name: 'mall.index', params: { mallId: mallId } }">
              <span><i class="fa fa-building"></i> 我的商城</span>
            </router-link>
          </li>
          <template v-if="myIdentities.loaded">
            <li class="dropdown identity-switch hidden-sm" v-if="myCompanies.list && myCompanies.list.length && myCompanies.list.length > 1" dropdown>
              <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">
                <span>切换公司</span> <b class="caret"></b>
              </a>
              <ul class="dropdown-menu company-switch-menu">
                <li v-for="item in myIdentities.list">
                  <template v-if="item.CompanyId">
                    <a class="clearfix" :class="{'active': item.CompanyId == myCompanyId}" @click="switchIdentity(item.Id, item.CompanyId)">
                      <i class="fc-icon fc-icon-success" v-if="item.Company.VerifyStatus == 1"></i>
                      <i class="fc-icon fc-icon-warn fc-icon_msg-primary" v-if="item.Company.VerifyStatus == 0"></i>
                      <i class="fc-icon fc-icon-warn" v-if="item.Company.VerifyStatus == -1"></i>
                      <small class="pull-right" v-if="item.Company.VerifyStatus == 1">已认证</small>
                      <small class="pull-right" v-if="item.Company.VerifyStatus == 0">未认证</small>
                      <span>{{ item.Company.BrandName }}</span>
                    </a>
                  </template>
                </li>
                <template v-if="myOwnCompanies.length">
                  <li class="divider"></li>
                  <li>
                    <router-link :to="{ name: 'my.companies' }">
                      <i class="fa fa-cogs"></i>  我创建的公司
                    </router-link>
                  </li>
                  <li>
                    <router-link :to="{ name: 'company.new' }">
                      <i class="fa fa-edit"></i>  创建新公司
                    </router-link>
                  </li>
                </template>
              </ul>
            </li>
            <li v-else>
              <router-link :to="{ name: 'company.new' }">
                <i class="fa fa-plus-square-o"></i> <span>创建公司</span>
              </router-link>
            </li>
          </template>
          <li>
            <a @click="goToPage('circles.following.stream')">
              <span><i class="fa fa-heart"></i> 我的关注</span>
            </a>
          </li>
          <!-- <li>
            <a>
              <span><i class="fa fa-star"></i> 我的收藏</span>
            </a>
          </li> -->
        </ul>
    </div>
    <el-dialog title="欢迎来到辅城，请先登录" v-model="loginDialogVisible" :modal-append-to-body="false" size="tiny">
      <login-dialog-form v-on:close="closeLoginDialog"></login-dialog-form>
    </el-dialog>
</div>
