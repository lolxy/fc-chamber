<div class="article-manager">
  <el-form ref="articleForm" :model="articleForm" :rules="rules" class="articleFormBox">
    <div class="col-sm-12 col-md-9">
      <el-form-item label="标题" prop="title">
        <el-input v-model="articleForm.title" placeholder="文章标题"></el-input>
      </el-form-item>
      <div class="row">
        <div class="col-sm-5">
          <el-form-item label="文章模块" prop="type">
              <el-select v-model="articleForm.type" placeholder="请选择模块类型" @visible-change="initSelectCategory()">
                <el-option
                  v-for="item in typeOptions"
                  :key="item.value"
                  :label="item.label"
                  :value="item.value">
                </el-option>
              </el-select>
          </el-form-item>
        </div>
        <div class="col-sm-5" v-if="articleForm.type">
          <el-form-item label="文章分类" prop="categoryId">
            <el-select v-model="articleForm.categoryId" placeholder="请选择文章分类">
              <el-option
                v-for="item in getFilterOptions(articleForm.type)"
                :key="item.id"
                :label="item.categoryName"
                :value="item.id">
              </el-option>
            </el-select>
          </el-form-item>
        </div>
        <div class="col-sm-2">
          <el-button style="margin-top:36px;" @click="dialogCategoryVisible = true" icon="setting" class="btn-sm"> 管理分类</el-button>
        </div>
      </div>
      <el-form-item label="摘要" prop="abstractContent">
        <el-input type="textarea" :rows="2" :maxlength="100" placeholder="请输入摘要" v-model="articleForm.abstractContent"></el-input>
      </el-form-item>
      <el-form-item label="内容" prop="content">
        <froala id="froala-editor" :tag="'textarea'" :config="config" v-model="articleForm.content" ref="froala"></froala>
      </el-form-item>
    </div>
    <div class="col-sm-12 col-md-3">
      <el-form-item label="封面">
        <div class="cover-uploader-wrap">
          <el-upload
            class="avatar-uploader"
            :action="uploadUrl"
            :on-success="handleSuccess"
            :before-upload="beforeUpload"
            :data="imageData"
            :show-file-list="false"
            :with-credentials="true"
            ref="imageUploader">
            <template v-if="coverImage.length!=0">
              <img :src="coverImage[0]" class="cover-thumb"/>
            </template>
            <template v-else>
              <i class="el-icon-plus avatar-uploader-icon"></i>
            </template>
          </el-upload>
        </div>
      </el-form-item>
      
      <el-form-item label="推荐">
        <el-switch on-text="" off-text="" v-model="articleForm.isTop"></el-switch>
      </el-form-item>
      <el-form-item label="发布">
        <el-switch on-text="" off-text="" v-model="articleForm.isPublish"></el-switch>
      </el-form-item>
      <el-form-item class="action-row">
        <template v-if="route.name == 'cham.article.new'">
          <el-button type="primary" @click="createNew('articleForm')">立即创建</el-button>
        </template>
        <template v-else>
          <el-button type="primary" @click="saveChanges">保存更改</el-button>
          <el-button type="default" @click="previewThis">查看预览</el-button>
        </template>
      </el-form-item>
    </div>
  </el-form>

  <el-dialog title="图片管理" v-model="imageManagerDialogVisible" size="large">
    <image-manager v-on:insertImageDone="closeImageManagerDialog" :status="imageManagerDialogVisible"></image-manager>
  </el-dialog>

  <el-dialog title="分类管理" :visible.sync="dialogCategoryVisible" size="large" class="categoryManagerBox">
    <categoryManager></categoryManager>
</el-dialog>
</div>
